<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unipet Services</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}
body{background:#f1f3f6}

/* HEADER */
header{
background:#2874f0;
padding:10px 20px;
display:flex;
align-items:center;
gap:20px;
color:white;
}

.logo{font-weight:600;font-size:18px}
.search-box{flex:1}
.search-box input{width:100%;padding:8px;border:none;border-radius:4px}

/* CATEGORY */
.categories{display:flex;gap:10px;padding:10px}
.categories button{
padding:6px 12px;border:none;border-radius:4px;cursor:pointer
}
.categories .active{background:#2874f0;color:white}

/* PRODUCTS */
.products{
display:grid;
grid-template-columns:repeat(2,1fr);
gap:15px;
padding:15px;
}

.card{
background:white;
padding:12px;
border-radius:6px;
box-shadow:0 2px 6px rgba(0,0,0,0.08);
}

.price{font-weight:600;margin:5px 0}
.quantity{display:flex;gap:8px;align-items:center}
.quantity button{padding:3px 8px;border:none;background:#2874f0;color:white}
.add-btn{
margin-top:6px;
background:#ff9f00;
color:white;
border:none;
padding:6px;
width:100%;
cursor:pointer;
}

/* CART BUTTON */
.cart-btn{
position:fixed;
bottom:20px;
right:20px;
background:#2874f0;
color:white;
padding:14px;
border-radius:50%;
cursor:pointer;
}

.cart-count{
position:absolute;
top:-5px;
right:-5px;
background:red;
color:white;
padding:2px 6px;
font-size:12px;
border-radius:50%;
}

/* CART PANEL */
.cart-panel{
position:fixed;
right:-350px;
top:0;
width:350px;
height:100%;
background:white;
padding:20px;
transition:0.3s;
overflow:auto;
box-shadow:-3px 0 8px rgba(0,0,0,0.1);
}

.cart-panel.active{right:0}

.cart-item{
display:flex;
justify-content:space-between;
align-items:center;
margin:6px 0;
}

.remove{
background:red;
color:white;
border:none;
padding:2px 6px;
cursor:pointer;
font-size:11px;
}

.total{margin-top:8px;font-weight:600}

input,select{
width:100%;
margin-top:8px;
padding:6px;
}

.place{
margin-top:10px;
background:#2874f0;
color:white;
border:none;
padding:8px;
width:100%;
cursor:pointer;
}

.location-btn{
margin-top:6px;
background:#0F2A3F;
color:white;
border:none;
padding:6px;
width:100%;
cursor:pointer;
}
</style>
</head>

<body>

<header>
<div class="logo">Unipet Services</div>
<div class="search-box">
<input type="text" id="search" placeholder="Search pet food...">
</div>
</header>

<div class="categories">
<button class="active" onclick="setCategory('all',this)">All</button>
<button onclick="setCategory('dog',this)">Dog</button>
<button onclick="setCategory('cat',this)">Cat</button>
</div>

<div class="products" id="product-list"></div>

<div class="cart-btn" onclick="toggleCart()">
ðŸ›’ <span class="cart-count" id="cart-count">0</span>
</div>

<div class="cart-panel" id="cartPanel">
<h3>Your Cart</h3>
<div id="cartItems"></div>

<input type="text" id="name" placeholder="Your Name">
<input type="text" id="phone" placeholder="Phone Number">
<input type="text" id="address" placeholder="Full Address">

<select id="payment">
<option value="COD">Cash on Delivery</option>
<option value="Online">Online Payment</option>
</select>

<button class="location-btn" onclick="getLocation()">Use Current Location</button>
<button class="place" onclick="placeOrder()">Place Order</button>
</div>

<script>
emailjs.init("B1bbMrGsxv1o4hUd5");

/* PRODUCTS */
const products=[
{id:1,name:"Pedigree 1kg Adult",price:209,category:"dog"},
{id:2,name:"Pedigree 3kg Adult",price:599,category:"dog"},
{id:3,name:"Purepet Cat 1kg",price:189,category:"cat"},
{id:4,name:"Whiskas Cat 1kg",price:409,category:"cat"}
];

let cart=JSON.parse(localStorage.getItem("cart"))||[];
let userLocation=localStorage.getItem("location")||"";
let currentCategory="all";

/* ORDER ID */
function generateOrderID(){
let d=new Date();
return "UNI"+d.getFullYear()+String(d.getMonth()+1).padStart(2,'0')+
String(d.getDate()).padStart(2,'0')+"-"+Math.floor(1000+Math.random()*9000);
}

function saveCart(){
localStorage.setItem("cart",JSON.stringify(cart));
}

/* RENDER PRODUCTS */
function renderProducts(){
let container=document.getElementById("product-list");
container.innerHTML="";
let search=document.getElementById("search").value.toLowerCase();

products
.filter(p=>p.name.toLowerCase().includes(search))
.filter(p=>currentCategory==="all"||p.category===currentCategory)
.forEach(p=>{
container.innerHTML+=`
<div class="card">
<div>${p.name}</div>
<div class="price">â‚¹${p.price}</div>
<div class="quantity">
<button onclick="changeQty(${p.id},-1)">-</button>
<span id="qty-${p.id}">1</span>
<button onclick="changeQty(${p.id},1)">+</button>
</div>
<button class="add-btn" onclick="addToCart(${p.id})">Add to Cart</button>
</div>`;
});
}

document.getElementById("search").addEventListener("input",renderProducts);

function setCategory(cat,btn){
currentCategory=cat;
document.querySelectorAll(".categories button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
renderProducts();
}

function changeQty(id,val){
let el=document.getElementById("qty-"+id);
let q=parseInt(el.innerText)+val;
if(q<1) q=1;
el.innerText=q;
}

function addToCart(id){
let qty=parseInt(document.getElementById("qty-"+id).innerText);
let product=products.find(p=>p.id===id);
let existing=cart.find(i=>i.id===id);

if(existing){existing.qty+=qty;}
else{cart.push({...product,qty});}

updateCart();
saveCart();
}

function removeItem(id){
cart=cart.filter(i=>i.id!==id);
updateCart();
saveCart();
}

function updateCart(){
let html="";
let total=0;
let totalQty=0;

cart.forEach(i=>{
let t=i.price*i.qty;
total+=t;
totalQty+=i.qty;
html+=`
<div class="cart-item">
<span>${i.name} x${i.qty}</span>
<span>â‚¹${t}</span>
<button class="remove" onclick="removeItem(${i.id})">X</button>
</div>`;
});

let delivery= total>=999?0:40;
let finalTotal=total+delivery;

html+=`<div class="total">Subtotal: â‚¹${total}</div>`;
html+=`<div class="total">Delivery: â‚¹${delivery}</div>`;
html+=`<div class="total">Total: â‚¹${finalTotal}</div>`;

document.getElementById("cartItems").innerHTML=html;
document.getElementById("cart-count").innerText=totalQty;
}

function toggleCart(){
document.getElementById("cartPanel").classList.toggle("active");
}

function getLocation(){
navigator.geolocation.getCurrentPosition(pos=>{
userLocation=`https://maps.google.com/?q=${pos.coords.latitude},${pos.coords.longitude}`;
localStorage.setItem("location",userLocation);
alert("Location Captured");
});
}

function placeOrder(){
if(!userLocation){alert("Please share location first");return;}
if(cart.length===0){alert("Cart is empty");return;}

let name=document.getElementById("name").value.trim();
let phone=document.getElementById("phone").value.trim();
let address=document.getElementById("address").value.trim();
let payment=document.getElementById("payment").value;

if(!name||!phone||!address){alert("Fill all details");return;}
if(!/^[6-9]\d{9}$/.test(phone)){alert("Invalid Indian number");return;}

let orderID=generateOrderID();

let text=`New Order\nOrder ID: ${orderID}\nName: ${name}\nPhone: ${phone}\nAddress: ${address}\nPayment: ${payment}\nLocation: ${userLocation}\n\n`;

let total=0;
cart.forEach(i=>{
let t=i.price*i.qty;
total+=t;
text+=`${i.name} x${i.qty} = â‚¹${t}\n`;
});

let delivery= total>=999?0:40;
let finalTotal=total+delivery;

text+=`\nDelivery: â‚¹${delivery}\nTotal: â‚¹${finalTotal}`;

window.open(`https://wa.me/919864696468?text=${encodeURIComponent(text)}`);

alert("Order Placed!\nYour Order ID: "+orderID);

cart=[];
localStorage.removeItem("cart");
updateCart();
toggleCart();
}

renderProducts();
updateCart();
</script>

</body>
</html>
